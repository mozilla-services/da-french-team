<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Service de nuages, ">

        <link rel="alternate"  href="https://mozilla-services.github.io/servicedenuages.fr/feeds/all.atom.xml" type="application/atom+xml" title="Service de nuages Full Atom Feed"/>

        <title>Prototyping an app with Kinto // Service de nuages // </title>


    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/pure/0.3.0/pure-min.css">
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.1.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="https://mozilla-services.github.io/servicedenuages.fr/theme/css/pure.css">
    <link rel="stylesheet" href="https://mozilla-services.github.io/servicedenuages.fr/theme/css/pygments.css">

    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/fitvids/1.0.1/jquery.fitvids.min.js"></script>
    <script>
        $(document).ready(function(){
            $(".content").fitVids();
        });
    </script>
</head>

<body>
<div class="pure-g-r" id="layout">
    <div class="sidebar sidebar-article pure-u">
        <header class="header-article">
            <hgroup>
                <h5>Published</h5>
                <p title="~734 words">~3 minutes reading ðŸ•‘</p>
                <p>Thu, 15 December 2016</p>
                <a href="/en/">&larr; Back to articles</a>
            </hgroup>
        </header>
    </div>
    <div class="pure-u">
        <div class="content">
            <section class="post">
                <header class="post-header">
                    <h1>Prototyping an app with Kinto</h1>
                </header>
            </section>
            <p>I own a car. And it costs a lot. But how much exactly is difficult to know, because the costs are spread between maintenance, repairs, fuel, insurance...
What if I could store each expense right on the spot, categorize it, and maybe add a description? That would be tremendously helpful, right?</p>
<p>In order to build something like that, I'd normally have to fire up a django project, maybe use django-rest-framework to have a proper REST API for the future web or mobile application. Then choose a database like postgresql and configure it.</p>
<p>But I'm not even sure it's a good idea! Maybe we can instead give it a try using the <a href="https://github.com/Kinto/kinto-admin/">kinto-admin</a>.</p>
<h2>Let's get started</h2>
<p>Let's first think about the data model:</p>
<ul>
<li>title: a string</li>
<li>comment: a multiline string</li>
<li>category: a string taken from a list of choices</li>
<li>price: a float</li>
</ul>
<p>And then how to store entries in Kinto:</p>
<ul>
<li>we'll have a bucket (<code>track-my-expenses</code>) which contains a collection (<code>car-expenses</code>)</li>
<li>a <a href="https://kinto.readthedocs.io/en/latest/api/1.x/collections.html#collection-json-schema">JSON schema</a> on the collection will validate the data before it's stored in records</li>
<li>and a <a href="https://github.com/mozilla-services/react-jsonschema-form/blob/master/README.md#the-uischema-object">UI schema</a> to improve the way the form is displayed in the admin (eg. a textarea for the comment instead of a single line text input).</li>
</ul>
<p>Our proof of concept will take advantage of the <a href="https://github.com/Kinto/kinto-admin/">kinto-admin</a> UI which gives us a way to create/read/update/delete entries (records).</p>
<h2>Create the bucket and the collection</h2>
<p>For our proof of concept, we'll use Mozilla's demo server, which is wiped clean every night: https://kinto.dev.mozaws.net/v1/.</p>
<p>Let's sign in to the <a href="https://kinto.dev.mozaws.net/v1/admin/">admin</a> with the user/pass of our choice.</p>
<p>Keep in mind that there's no <a href="http://kinto.readthedocs.io/en/stable/api/1.x/authentication.html#a-word-about-users">concept of user in Kinto</a>. Instead, a unique id will be generated from the authentication, and the data you enter/modify will be linked to it. Permissions are based on this mechanism.</p>
<p><img alt="kinto-admin-sign-in" src="https://mozilla-services.github.io/servicedenuages.fr/images/kinto-admin-sign-in.png" style="width: 2852px; height: auto; max-width: 100%;width: 2852px; height: auto; max-width: 100%;"/></p>
<p>Once connected, we can <a href="https://kinto.dev.mozaws.net/v1/admin/#/buckets/create">create a bucket</a>:</p>
<p><img alt="kinto-admin-connected" src="https://mozilla-services.github.io/servicedenuages.fr/images/kinto-admin-connected.png" style="width: 2806px; height: auto; max-width: 100%;width: 2806px; height: auto; max-width: 100%;"/>
<img alt="kinto-admin-create-bucket" src="https://mozilla-services.github.io/servicedenuages.fr/images/kinto-admin-create-bucket.png" style="width: 2832px; height: auto; max-width: 100%;width: 2832px; height: auto; max-width: 100%;"/></p>
<p>And then <a href="https://kinto.dev.mozaws.net/v1/admin/#/buckets/track-my-expenses/collections/create">create a collection</a>:</p>
<p><img alt="kinto-admin-create-collection" src="https://mozilla-services.github.io/servicedenuages.fr/images/kinto-admin-create-collection.png" style="width: 2810px; height: auto; max-width: 100%;width: 2810px; height: auto; max-width: 100%;"/></p>
<p>Let's not submit this new collection just yet, we'd first like to add a <a href="https://kinto.readthedocs.io/en/latest/api/1.x/collections.html#collection-json-schema">JSON schema</a>.</p>
<h2>Add a JSON schema</h2>
<p>As you can see while creating a collection, we have the option of adding a JSON schema. This schema will be used to validate the data we will submit, before it's stored in a record.
The schema will also be used to automatically generate the CRUD forms for our data, straight into the admin.</p>
<p>Following our data model, here's what the JSON schema should look like:</p>
<div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">"type"</span><span class="p">:</span> <span class="s2">"object"</span><span class="p">,</span>
  <span class="nt">"properties"</span><span class="p">:</span> <span class="p">{</span>
    <span class="nt">"title"</span><span class="p">:</span> <span class="p">{</span>
      <span class="nt">"type"</span><span class="p">:</span> <span class="s2">"string"</span><span class="p">,</span>
      <span class="nt">"title"</span><span class="p">:</span> <span class="s2">"Title"</span><span class="p">,</span>
      <span class="nt">"description"</span><span class="p">:</span> <span class="s2">"Short title for an expense"</span>
    <span class="p">},</span>
    <span class="nt">"comment"</span><span class="p">:</span> <span class="p">{</span>
      <span class="nt">"type"</span><span class="p">:</span> <span class="s2">"string"</span><span class="p">,</span>
      <span class="nt">"title"</span><span class="p">:</span> <span class="s2">"Comment"</span><span class="p">,</span>
      <span class="nt">"description"</span><span class="p">:</span> <span class="s2">"Provide details if needed..."</span>
    <span class="p">},</span>
    <span class="nt">"category"</span><span class="p">:</span> <span class="p">{</span>
      <span class="nt">"type"</span><span class="p">:</span> <span class="s2">"string"</span><span class="p">,</span>
      <span class="nt">"enum"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"fuel"</span><span class="p">,</span> <span class="s2">"repair"</span><span class="p">,</span> <span class="s2">"insurance"</span><span class="p">,</span> <span class="s2">"maintenance"</span><span class="p">,</span> <span class="s2">"equipment"</span><span class="p">],</span>
      <span class="nt">"title"</span><span class="p">:</span> <span class="s2">"Category"</span><span class="p">,</span>
      <span class="nt">"description"</span><span class="p">:</span> <span class="s2">"A category for this expense"</span>
    <span class="p">},</span>
    <span class="nt">"price"</span><span class="p">:</span> <span class="p">{</span>
      <span class="nt">"type"</span><span class="p">:</span> <span class="s2">"number"</span><span class="p">,</span>
      <span class="nt">"title"</span><span class="p">:</span> <span class="s2">"Price"</span><span class="p">,</span>
      <span class="nt">"description"</span><span class="p">:</span> <span class="s2">"The cost for this expense"</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
<p>Note the <code>enum</code> attribute on the category field which will be rendered in the forms as a select, instead of a simple input text field.</p>
<p><em>Tip:</em> You can use the <a href="https://kinto.github.io/formbuilder/">form builder</a> to build your form visually, and then copy the JSON schema to the admin!</p>
<p>Let's still not submit this new collection just yet, as we'll want to add a <a href="https://github.com/mozilla-services/react-jsonschema-form/blob/master/README.md#the-uischema-object">UI schema</a>.</p>
<h2>Add a UI schema to improve the forms</h2>
<p>Adding a <a href="https://github.com/mozilla-services/react-jsonschema-form/blob/master/README.md#the-uischema-object">UI schema</a> will improve the way the admin will display our data, and the forms to add/edit it.</p>
<div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">"ui:order"</span><span class="p">:</span> <span class="p">[</span>
    <span class="s2">"title"</span><span class="p">,</span>
    <span class="s2">"comment"</span><span class="p">,</span>
    <span class="s2">"category"</span><span class="p">,</span>
    <span class="s2">"price"</span>
  <span class="p">],</span>
  <span class="nt">"comment"</span><span class="p">:</span> <span class="p">{</span>
    <span class="nt">"ui:widget"</span><span class="p">:</span> <span class="s2">"textarea"</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
<p>The <code>ui:order</code> will be used to display the fields in the order we want (JSON objects attributes aren't ordered), and we also specify that we'd like a <code>textarea</code> for the comment field, instead of a single line input text field.</p>
<p>Nearly done! Just before submitting this new collection, let's configure the columns to be displayed in the record list page.</p>
<h2>Final touches</h2>
<p>By default, the admin will only display one column in the record list page. It would be much more convenient to display the <code>category</code> and <code>price</code> on top of the <code>title</code>:</p>
<p><img alt="kinto-admin-records-list-columns" src="https://mozilla-services.github.io/servicedenuages.fr/images/kinto-admin-records-list-columns.png" style="width: 2032px; height: auto; max-width: 100%;width: 2032px; height: auto; max-width: 100%;"/></p>
<h2>Profit!</h2>
<p>We now have everything we need for our proof of concept!</p>
<p>List the current records (there's none yet):
<img alt="kinto-admin-list-records" src="https://mozilla-services.github.io/servicedenuages.fr/images/kinto-admin-list-records.png" style="width: 2828px; height: auto; max-width: 100%;width: 2828px; height: auto; max-width: 100%;"/></p>
<p>Add a new record:
<img alt="kinto-admin-add-record" src="https://mozilla-services.github.io/servicedenuages.fr/images/kinto-admin-add-record.png" style="width: 2834px; height: auto; max-width: 100%;width: 2834px; height: auto; max-width: 100%;"/></p>
<p>Display the list of (sortable) records once we added a few:
<img alt="kinto-admin-list-records-many" src="https://mozilla-services.github.io/servicedenuages.fr/images/kinto-admin-list-records-many.png" style="width: 2834px; height: auto; max-width: 100%;width: 2834px; height: auto; max-width: 100%;"/></p>
<p>As you can see, without a single line of code and very small effort, we have a functional, albeit very basic, proof of concept!</p>
<p>While this is a nice and easy way to have a proof of concept, the admin's role is not meant to fulfill all your needs. If you wanted aggregation or filtering, you would still need a client, your own application.</p>
            <div class="hr"></div>
            <a href="#" class="go-top">Revenir au dÃ©but</a>
<div class="comments">
    <div id="disqus_thread"></div>
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = "servicedenuages"; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div><footer class="footer">
    <p>&copy; Service de nuages &ndash;
        DÃ©veloppÃ© avec <a href="https://github.com/PurePelicanTheme/pure">Pure Theme</a>
        et <a href="http://blog.getpelican.com/">Pelican</a>
    </p>
</footer>        </div>
    </div>
</div>
    <script>
        var $top = $('.go-top');

        // Show or hide the sticky footer button
        $(window).scroll(function() {
            if ($(this).scrollTop() > 200) {
                $top.fadeIn(200);
            } else {
                $top.fadeOut(200);
            }
        });

        // Animate the scroll to top
        $top.click(function(event) {
            event.preventDefault();
            $('html, body').animate({scrollTop: 0}, 300);
        })

        // Makes sure that the href="#" attached to the <a> elements
        // don't scroll you back up the page.
        $('body').on('click', 'a[href="#"]', function(event) {
            event.preventDefault();
        });
    </script>
<!-- Piwik -->
<script type="text/javascript">
  var _paq = _paq || [];
  _paq.push(['trackPageView']);
  _paq.push(['enableLinkTracking']);
  (function() {
    var u="//piwik.notmyidea.org/";
    _paq.push(['setTrackerUrl', u+'piwik.php']);
    _paq.push(['setSiteId', 1]);
    var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
    g.type='text/javascript'; g.async=true; g.defer=true; g.src=u+'piwik.js'; s.parentNode.insertBefore(g,s);
  })();
</script>
<noscript><p><img src="//piwik.notmyidea.org/piwik.php?idsite=1" style="border:0;" alt="" /></p></noscript>
<!-- End Piwik Code -->
  <script src="https://mozilla-services.github.io/servicedenuages.fr/theme/js/instantclick.min.js" data-no-instant></script>
  <script data-no-instant>InstantClick.init();</script>
</body>
</html>